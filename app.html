<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¥Ø¶Ø§ÙÙŠ Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ */
        .games-menu {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #333;
        }
        .game-btn {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: none;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            box-shadow: 0 5px 10px rgba(0,0,0,0.3);
            animation: none; /* Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù†Ø¨Ø¶ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØµØºÙŠØ±Ø© */
        }
        .game-btn:hover { transform: translateY(-3px); filter: brightness(1.2); }
        .game-btn img { width: 25px; height: 25px; filter: drop-shadow(0 2px 2px rgba(0,0,0,0.5)); }
    </style>
</head>
<body>
    <div class="live-counter" id="liveCounter" style="top:10px; right:10px;">Live: ...</div>

    <div class="container">
        <img src="11zon_cropped.png" alt="App Logo" class="pro-logo" style="width: 100px;">

        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; border: none; font-size: 1.3rem;">ğŸš€ Ù‡Ø§Ùƒ Ø§Ù„Ø·ÙŠØ§Ø±Ø© (Crash)</h2>
            <div style="font-size: 12px; color: var(--hacker-green); font-weight: bold; text-shadow:0 0 5px var(--hacker-green);">Ù†Ø´Ø· â—</div>
        </div>

        <p style="color: #ccc; margin-bottom: 15px;">Ø§Ù†ØªØ¸Ø§Ø± Ù†Ù‚Ø·Ø© Ø§Ù„ØµÙØ± Ù„Ù„Ø¥Ù†Ø·Ù„Ø§Ù‚...</p>

        <div class="monitor-screen" style="border-color: var(--warning-orange); box-shadow: 0 0 20px rgba(255, 174, 0, 0.15);">
            <div style="font-size: 0.8rem; color: #888; text-align: left; direction: ltr;">NEXT_CRASH_POINT</div>
            <div class="big-number" id="randomNumber" style="font-family:'Fira Code'; font-size:3.5rem; color:var(--warning-orange); font-weight:bold; text-shadow: 0 0 20px rgba(255, 174, 0, 0.4);">--.--</div>
            
            <div class="progress-bar" style="background:#222; height:6px; border-radius:5px; margin-top:20px; overflow:hidden;">
                <div class="progress-fill" id="progressFill" style="background:var(--warning-orange); height:100%; width:0%;"></div>
            </div>
            <div style="text-align: right; font-size: 0.7rem; color: #555; margin-top: 5px;">Syncing with 1xBet Server...</div>
        </div>

        <p style="text-align: right; font-size: 0.9rem; margin-top: 25px; color: #fff; font-weight: bold;">ğŸ® Ø£Ø¯ÙˆØ§Øª Ø§Ø®ØªØ±Ø§Ù‚ Ø£Ø®Ø±Ù‰:</p>
        <div class="games-menu">
            <button class="game-btn" onclick="window.location.href='apple.html'" style="background: linear-gradient(135deg, #d32f2f, #b71c1c);">
                <span>ğŸ</span>
                <span>Apple</span>
            </button>
            
            <button class="game-btn" onclick="window.location.href='crystal.html'" style="background: linear-gradient(135deg, #8e2de2, #4a00e0);">
                <span>ğŸ”®</span>
                <span>Crystal</span>
            </button>
        </div>

        <button class="secondary-btn" onclick="logout()" style="margin-top: 20px;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>

    <script>
        const SUPABASE_URL = 'https://zflgifemhopabfzgczgs.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_9xZcd3BkgL6cEQwHJitrew_mbX74lJW';
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        if (!localStorage.getItem('isLoggedIn')) window.location.href = 'index.html'; 

        setInterval(() => {
            document.getElementById('liveCounter').innerText = `Live: ${Math.floor(Math.random() * 50) + 300}`;
        }, 3000);

        const display = document.getElementById('randomNumber');
        const bar = document.getElementById('progressFill');
        const INTERVAL = 7000;
        let start = Date.now();

        // Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Crash)
        async function gen() {
            display.style.opacity = 0.5;

            let finalNumber = "1.00";

            try {
                const { data, error } = await _supabase.from('settings').select('*').eq('id', 1).single();
                
                if (data && data.mode === 'manual' && data.manual_list) {
                    const numbersArr = data.manual_list.split(/[\s,]+/).map(s => s.trim()).filter(s => s !== "");
                    if(numbersArr.length > 0) {
                        const timeIndex = Math.floor(Date.now() / INTERVAL);
                        const arrIndex = timeIndex % numbersArr.length;
                        finalNumber = numbersArr[arrIndex];
                    } else {
                        finalNumber = (Math.random() * 10 + 1).toFixed(2) + "x";
                    }
                } else {
                    // ÙÙŠ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø·ÙŠØ§Ø±Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¹Ø§Ø¯Ø© ØªÙƒÙˆÙ† Ù…ØªØ¨ÙˆØ¹Ø© Ø¨Ù€ x
                    finalNumber = (Math.random() * 5 + 1).toFixed(2) + "x";
                }

            } catch (err) {
                console.error("Connection Error", err);
                finalNumber = (Math.random() * 5 + 1).toFixed(2) + "x";
            }

            display.style.opacity = 0;
            setTimeout(() => { 
                display.innerText = finalNumber.includes('x') ? finalNumber : finalNumber + 'x'; 
                display.style.opacity = 1; 
                // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù‚ÙŠÙ…ØªÙ‡ (Ù„Ø¥Ø¶ÙØ§Ø¡ ÙˆØ§Ù‚Ø¹ÙŠØ©)
                if(parseFloat(finalNumber) < 2.0) display.style.color = "#ff3333"; // Ø®Ø³Ø§Ø±Ø© (Ø£Ø­Ù…Ø±)
                else display.style.color = "#ffae00"; // ÙÙˆØ² (Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ/Ø°Ù‡Ø¨ÙŠ)
            }, 200);

            start = Date.now();
        }

        function loop() {
            let elapsed = Date.now() - start;
            let remain = INTERVAL - elapsed;
            if(remain <= 0) gen();
            else bar.style.width = ((remain/INTERVAL)*100) + "%";
            requestAnimationFrame(loop);
        }

        function logout() {
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'index.html'; 
        }

        gen(); 
        requestAnimationFrame(loop); 
    </script>
</body>
</html>
